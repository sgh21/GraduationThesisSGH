\documentclass{Diploma}
%引入需要的宏包
\usepackage{amsmath}
%设置封面信息
\SetDepartment{机械工程系}
\SetMajor{机械工程}
\SetTitle{手机BTB插接件高精度高鲁棒位姿检测技术研究}
\SetAuthor{申广辉}
\SetInstructor{吴丹}{教授} 
% \SetJointInstructor{副指导}{副教授}
\begin{document}
% 摘要
\ChsAbstract 综合论文训练是本科教学的最后一个综合性实践环节，它要求学生根据自己的专业志趣选题，并在教师指导下综合运用已掌握的知识或通过学习新知识，完成一项课题研究或相应的综合训练任务，并独立完成一篇论文，作为学生的“学士学位论文”。
 
本文制定了综合论文的统一格式，避免论文格式上的混乱，同时也减少学生在文档格式编辑上所耗费的时间。另外还总结了少量的论文写作技巧供学生参考。

为了使学生更容易上手\LaTeX ，本文简短的介绍了一些\LaTeX 的常用命令及软件安装等入门知识。

\ChsKeywords{综合论文训练；LaTeX排版；文档格式；写作技巧}

\EngAbstract Diploma project is the final section of comprehensive practice for undergraduate students. The student should determine a project according to whose own professional interesting, and complete the project independently under the instructing of supervisor. An integral thesis paper should be accomplished by student, which is necessary for applying the bachelor's degree.

In this paper, a standard format of thesis in \LaTeX\ system was defined, which can avoid the confusion of different papers from different authors. At the same time, the time consuming of format editing can be saved. Additionally, some of the science writing skills were recommended in this paper.

To make it easier for students to get started with \LaTeX, this paper briefly introduces some common commands and basic knowledge such as software installation for \LaTeX .

\EngKeywords{diploma project; LaTeX editing; document format; writing skills}

% 目录及图表清单
\ListOfContents
% 符号和缩略语说明
\begin{Abbreviations}
\TeX & 一种文字排版系统\\
\LaTeX & \TeX 系统的扩充\\
\LaTeXe & \LaTeX 的中间版本\\
规范 & 《清华大学综合论文训练写作规范（试行）》 \\
环境 & 形如“\char92 begin……\char92 end”的成对指令，指令之间是内容段落\\  
命令 & 形如“\char92 TeX”这样的单个指令\\
伪代码 & \LaTeX 文档的源文件，后缀为“tex”\\
\end{Abbreviations} 

\StartMainText% 正文开始

\chapter[preface]{引言}
\section{研究背景与意义}
随着智能科技和信息化产业的飞速发展，智能手机已成为人们生活中不可或缺的重要设备。据2024年Omdia发布的《智能手机机型市场跟踪报告》显示，在2024年上半年，仅iPhone 15ProMax全球出货量就高达2180万部。所有型号手机每季度全球出货量更是高达2.88亿部。而在手机设计和制造过程中，其硬件部件需要经过精密装配以确保性能和质量。其中，作为连接手机主板与屏幕、电池等功能模块的核心零件，BTB（Board-to-Board）连接器的插接质量对整个装配效果至关重要。

当前，BTB连接器的装配过程主要依赖人工操作。然而，随着手机部件微型化趋势的加剧，传统人工操作逐渐暴露出产品一致性差和生产效率低的问题。因此，迫切需要使用自动化技术实现BTB连接自动插接，提高生产效率和产品质量。
\InsertFigure[ManualConnection]{}{人工插接示意图}{preface/ManualConnection.png}%

本课题旨在面向手机装配生产流水线，应用自动化技术，开发手机BTB连接器全流程批量自动装配系统，实现识别抓取、检测对准和插入控制核心步骤，解决实际生产需求，提高装配效率。

手机BTB连接器批量自动插接可细分为识别抓取、检测对准和插入控制三个步骤。其中识别抓取受到机械臂绝对定位误差和视觉标定误差的制约，存在不可避免的毫米级误差，因此对于更精密的装配任务，必须进行补偿和修正。在工业流水线中，一般会选择进行在手位姿检测确定零件的对手位姿，随后在完成对准之后进行插入。基于位置控制的插入控制策略机械臂不会主动对外感知，如果检测对准超出容差，会导致零件损坏。为了保证插入过程安全可靠，通常采用阻抗/导纳控制等力控策略，进行柔顺插入。在以上三个步骤中，识别抓取相对简单，并且由于毫米级误差不可避免，因此无需过度苛求检测的精度，现有的基于Yolo分割的算法足以满足精度需求，高精度高鲁棒的位姿检测算法既可以减轻柔顺插入控制策略的开发难度，也是插接可靠性的重要保障。因此，开发具有高精度和高鲁棒的位姿检测算法具有重要意义。
\section{国内外研究现状}
本论文主要聚焦于手机BTB连接器的位姿检测算法。位姿检测环节的目的是消除由于抓取产生的误差，检测零件在图像中的相对位姿，再通过标定转换获得零件对机器人末端工具坐标系的相对位姿或者对于机器人基坐标系的绝对位姿。

现有的位姿检测算法主要有基于特征工程的传统视觉算法、结合深度学习的传统视觉算法、多模态深度学习算法和视觉伺服控制算法四类。下面将对这几类算法按照技术发展脉络进行介绍与分析。
\subsection{基于特征工程的传统视觉}
此类方法的核心思想是基于先验知识，归纳设计零件用于定位的特征，如颜色、边缘等信息，随后借助边缘检测、特征拟合等手段确定零件在图像中的局部位姿，再通过标定转换，获得其全局位姿。因此定位精度取决于零件特征拟合质量和标定转换精度。

Wang等针对3C装配领域的薄片零件对象，从2D图像中提取薄片零件的边缘轮廓，再根据零件的CAD数模和当前估计位姿，实现3D到2D的重投影，将重投影边缘和提取边缘进行误差优化，通过优化过程从而获得平移误差仅0.03mm，旋转误差仅0.1°的高精度六维位姿。此方法通过改善特征拟合的质量构建了优化过程，但其优化过程建立依赖于CAD数模和零件边缘轮廓的解析表达式，具有较强的先验依赖，因此对于不同的零件较难拓展\cite{wang2025high}。
\InsertFigure[Wang]{}{基于特征工程的传统视觉算法示意图\cite{wang2025high}}{preface/Wang.png}%

Jiang等为了减小机械臂的绝对定位误差导致的标定转换误差，在执行器末端增设标志点，使用固定的全局相机和在机械臂末端的局部相机构成两级视觉系统，进行动态坐标标定和全局校准，完成了0.1mm的轴孔装配任务，提高了标定转换环节的精度\cite{jiang2020measurement}。

此类方法的优势在于其精度高，方法简单并且计算开销小，因此在工业界应用最为广泛。但基于传统视觉的方法很容易受到光照变化、油渍和视角遮挡等问题的影响，不够鲁棒，并且算法的精度依赖于特征提取的质量，特征难提取或特征点少时精度明显下降，甚至存在检测失败的情况。另外，对于不同零件的特征需要进行精巧设计，难以泛化。
\subsection{传统视觉结合深度学习}
为了提高特征提取的鲁棒性，有学者提出传统视觉和深度学习结合的方法。此类方法的核心思想是借助深度学习的特征提取能力，完成主要特征提取或实例分割，给出感兴趣区域，再利用传统算法对特征区域进行进一步的特征分析，完成由粗到精的定位过程。

Mou等使用Yolo结合传统算法的方法，其引入了两个Yolo模型分别完成连接器的识别，给出连接器的感兴趣区域和连接器针脚分割，给出连接器的针脚位置。得益于Yolo成熟的框架，在Yolo预训练模型基础上实现上述功能仅需要几千组数据，这对于神经网络训练来说是属于很小的量级。在给出针脚位置后，其根据先验对针脚位置流行进行校正，使用主成分分析，获取流形主方向，完成了平移误差0.36mm，旋转误差0.44°的位姿检测\cite{fangli2022pose}。
\InsertFigure[Mou]{}{传统视觉结合深度学习算法示意图\cite{fangli2022pose}}{preface/Mou.png}%

此类方法能一定程度上提高位姿检测的鲁棒性，问题在于后续传统视觉的处理使其仍然存在依赖先验和泛化难的问题，并且精度仍然较大程度上受最终特征提取的制约。
\subsection{多模态深度学习}
深度学习的快速发展使得通过数据驱动的方法在鲁棒性上有了飞速的提升，并且深度学习的特征提取能力使得其不再依赖于特征设计，能够自动从数据中学习到特征，因此在泛化性上也表现出了巨大的潜力。此类方法的核心思想在于，使用神经网络对输入进行特征编码，完成特征提取，随后对特征进行相应任务回归，获得回归输出，并和标签进行比对，通过比对的损失回传，更新网络参数，优化特征提取和回归过程。为了克服插接任务的视角遮挡，并充分训练网络的特征提取能力，有学者提出了多模态深度学习的方法，通常分为多视角输入和多类型传感输入两类。

Yang等引入数字孪生技术，通过识别调姿平台的角点，获取单应性矩阵创建孪生环境，并在孪生环境中采集无遮挡视角视图，从而构成多视角输入。多视角视图输入给卷积神经网络进行特征层拼接，完成数据融合，输出估计位姿。此方法解决了插入过程对准视角遮挡的问题，完成了BTB连接器零件插接任务\cite{yang2023digital}。
\InsertFigure[Yang]{}{多模态深度学习算法示意图\cite{yang2023digital}}{preface/Yang.png}%

Li等则引入触觉传感器，搭建了稳健视触觉网络，通过补偿模块应对单一模态缺失的问题，因此可以保证当视觉受到干扰或质量变差时依然能够凭借触觉信息完成对准，提高了位姿检测的鲁棒性\cite{li2024v}。

此类方法对光照、遮挡的鲁棒性好，精度相对较高。但是其训练时间和数据获取成本相对更高，并且其研究任务仍然停留在数据集测试层面，没有考虑到实际部署时存在的问题，比如其在数据采集时一般采用机械臂与零件协同运动的策略，这导致数据中零件和背景同步运动，但实际部署时机械臂末端在固定拍照，因此背景始终保持不动，这种差异会使得基于学习的视觉位姿检测在实际部署时精度显著下降。
\subsection{视觉伺服控制}
除上述三种通过分析单帧图像获得位姿外，还有一类另辟蹊径的方法，既然单次检测不够精准，其不直接测量轴孔的绝对位姿，而是将传感器作为伺服系统，在插入过程中进行实时测量，采取定位误差补偿的策略，完成对准，此类方法的核心在于伺服控制和搜索策略。

伺服传感器一般选择视觉传感器或力觉传感器，但视觉传感器在插入过程往往存在视角遮挡，图像质量较差，而力传感器数据则不直观，难以获得从力到位移的直接映射关系。因此，在伺服控制策略的最新研究中，往往引入强化学习智能体，采用感知、调整、评价的迭代步骤进行策略学习，通过数据驱动的方式来进行实时的反馈和调整，最终获得能自主调整和搜索的智能体。

Zhao等使用先粗后精的视觉伺服引导，首先使用视觉传感器完成粗略位姿检测完成粗定位，缩小搜索空间，随后在精确对准环节，将视觉作为伺服系统，训练强化学习智能体进行轴孔对准，完成了USB连接器的插接任务，给出了连接器装配新思路\cite{zhao2023learning}。
\InsertFigure[Zhao]{}{视觉伺服控制算法示意图\cite{zhao2023learning}}{preface/Zhao.png}%

此类方法针对不同尺寸的轴孔迁移快，泛化强，但基于强化学习的方法训练往往依赖于仿真器。一方面，对于低刚度并且在插接过程存在弹性变形的对象，难仿真建模，因此训练难以开展。另一方面，在仿真中开展模型训练存在仿真到现实迁移的困难，这依然是制约强化学习在实际工程应用最大的困难。
\subsection{位姿检测技术路线梳理}
针对以上方法进行总结，位姿技术发展路线如\ref{fig:DetectionTech}所示，基于特征工程的传统视觉精度高，方法简单，方便部署和应用，但其对环境鲁棒性和对不同零件泛化性差。引入深度学习加强的传统视觉其泛化性和鲁棒性得到提升，但带来了和精度下降问题。而使用多模态深度学习在精度和鲁棒性上都表现出了巨大潜力，但目前研究没有考虑实际部署和训练的差异。而使用伺服系统的策略，需要引入强化学习智能体，但其针对难以仿真建模的对象的无法训练和从训练到现实的迁移的问题还没有成熟的解决方案。
\InsertFigure[DetectionTech]{1.0\textwidth}{检测对准技术发展路线}{preface/DetectionTech.png}

针对本课题研究的手机BTB插接对象的特，现有方案在应对手机BTB插接对象时仍存在不足。因此，本课题的首要目标是开发一种兼具高精度、强泛化性、低成本，且无需依赖复杂模型的检测对准算法。
\section{研究目标与内容}
\subsection{研究目标}
本课题面向手机BTB连接器插接的应用需求，搭建全流程自动插接系统，实现识别抓取、位姿检测和柔顺插入控制。并且解决多种类型BTB连接器的批量自动化插接中的位姿检测问题，重点提升高精度、高鲁棒性与强泛化性。具体目标包括：
\begin{itemize}
  \item 高精度：实现位姿检测的平移精度达到0.1mm，旋转精度达到0.25°； 
  \item 高鲁棒：能够适应光照变化、背景干扰、不同批次零件表面质量等复杂工况；
  \item 强泛化性：适配针脚数量范围为24P至40P，针脚间距为0.35mm至0.4mm的多种BTB连接器类型； 
\end{itemize}
\subsection{研究内容}
本研究的主要研究内容可分为以下几个方面：
\begin{enumerate} 
  \item 基于数据驱动的位姿检测网络框架设计：设计数据驱动的视觉检测网络框架，给出网络的整体结构和主要模块设计，给出数据集构建与训练方法。
  \item 位姿检测网络详细结构设计与优化：针对标准网络框架，分析其存在的问题，并给出问题解决方案，给出视触觉位姿检测网络的结构，详细模块设计，实验对比与分析结果。
  \item 综合实验与分析：搭建实机硬件系统，给出系统数学模型与坐标系标定，给出软件系统框架设计，实现识别抓取算法模块、检测对准算法模块和柔顺插入控制算法模块的设计与实现，给出综合实验效果与分析。
\end{enumerate}
\section{社会责任分析}
本课题面向手机BTB连接器的自动化插接需求，所研究的高精度位姿检测和柔顺装配技术，在具体工业场景中具有显著的实用价值和社会效益：

\begin{itemize}
\item \textbf{提升产品一致性与减少报废率：} 在当前人工插接中，由于定位误差和插接不当导致的针脚弯折或连接器损坏问题较为常见，影响产品一致性。本课题通过引入高精度视觉检测和柔顺插入控制技术，有望显著降低装配过程中的不良率和返工次数，减少资源浪费。

\item \textbf{降低重复性劳动带来的健康风险：} 长时间进行细微装配操作容易导致工人眼疲劳、手腕损伤等职业病。实现插接过程自动化可减轻人工负担，改善生产一线工人的工作环境和身体健康风险。

\item \textbf{增强中小企业的技术可及性：} 本课题强调“高精度、强泛化、低成本”的设计原则，目标是实现不依赖昂贵设备和复杂建模的解决方案。这对于资金与技术储备有限的中小型制造企业来说更具可推广性，具有现实落地的可能。
\end{itemize}
\section{本章小结}
本章围绕手机BTB连接器插接自动化背景，阐述了本研究的动因与必要性，并系统综述了国内外在位姿检测领域的主流方法，涵盖基于特征工程的传统视觉、融合深度学习的混合方法、多模态深度学习方法与视觉伺服控制策略，剖析其优劣与适用边界，指出现有技术在泛化性、鲁棒性及实际部署方面的不足。

在此基础上，明确了本研究的技术目标，包括实现高精度、高鲁棒性与强泛化能力的位姿检测，支持多种类型BTB连接器的自动插接。随后详细提出了本研究的主要内容与技术路线，包括检测网络设计、模块优化、系统集成与实验验证。

\chapter[framework]{数据驱动的位姿检测网络框架设计}
位姿检测是实现手机BTB连接器插接的核心环节，本章将首先对位姿检测问题进行详细的描述，并分析其任务难点，给出针对该任务的网络设计思路，数据集构建和训练方法。

\section{相对位姿检测问题描述与难点}

\subsection{问题描述}
视觉位姿检测是实现零件插接的关键环节，此环节的目的是消除由于抓取产生的误差，获得零件对工具坐标系末端的相对准确的位姿，从而引导引导机械臂在插入过程中对抓取误差进行补偿。

\InsertFigure[CoordinateSystem]{0.8\textwidth}{位姿检测坐标系统示意图}{framework/CoordinateSystem.png}%

实际的坐标系定义如\ref{fig:CoordinateSystem}所示，世界坐标系为$T_{world}$，机械臂末端工具坐标系为$T_{tool}$，相机坐标系为$T_{camera}$，零件坐标系为$T_{part}$。位姿检测的任务是获得零件坐标系$T_{part}$相对于机械臂末端工具坐标系$T_{tool}$的位姿$T_{part}^{tool}$，即\eqref{eq:pose1}所示。
\begin{equation}
  T_{part}^{tool} =T_{world}^{tool} \cdot T_{camera}^{world} \cdot T_{part}^{camera} \label{eq:pose1}
\end{equation}

其中$T_{camera}^{world}$是相机坐标系在世界坐标系下的位姿，通过手眼标定获取，在多次抓取时保持不变，$T_{world}^{tool}$ 是机械臂末端工具坐标系相对基座标系的位姿，可以通过机械臂的编码器读数获取。因此，$T_{part}^{tool}$的计算可以转化为$T_{part}^{camera}$的计算，即从像素坐标系中提取出零件的位姿信息，再通过内参矩阵转换到相机坐标系下。

\InsertFigure[PictureCoordinateSystem]{0.4\textwidth}{像素坐标系和相机坐标系}{framework/PictureCoordinateSystem.png}%

为了使用深度学习进行相对位姿检测，需要获取每次抓取时零件在相机坐标系下的位姿真值，使用已有的算法获取零件位姿真值会引入预测误差，因此为了获得更为准确的真值，需要通过机械臂单次抓取，并进行相对移动，根据机械臂末端的相对移动，给出零件相对于相机的相对位移真值，其数学关系如\eqref{eq:pose2}所示。
\begin{equation} \label{eq:pose2}
\begin{aligned} 
  T_{part}^{tool}(t) &= T_{world}^{tool}(t) \cdot T_{camera}^{world} \cdot T_{part}^{camera}(t)  \\
  T_{part}^{tool}(t+1) &= T_{world}^{tool}(t+1) \cdot T_{camera}^{world} \cdot T_{part}^{camera}(t+1) \\
  T_{part}^{tool}(t) &= T_{part}^{tool}(t+1) 
\end{aligned}
\end{equation}

\eqref{eq:pose2}整理，可得：
\begin{equation} \label{eq:pose3}
    (T_{world}^{tool}(t+1))^{-1} \cdot T_{world}^{tool}(t) \cdot T_{camera}^{world} = T_{camera}^{world} \cdot T_{part}^{camera}(t+1) \cdot (T_{part}^{camera}(t))^{-1}
\end{equation}

\eqref{eq:pose3}左侧为机械臂末端工具坐标系在世界坐标系下的相对位姿，右侧为零件在相机坐标系下的相对位姿。由于机械臂末端工具坐标系在世界坐标系下的位姿是通过机械臂编码器读数获得的，精度较高。因此，可以使用机械臂末端工具坐标系在世界坐标系下的相对位姿，作为零件在相机坐标系下的相对位姿的真值，并将其作为网络的标签进行训练。

于是，使用深度学习进行相对位姿检测的任务可以转化为，输入机械臂相对移动的两张图片，输出两张图片相对相机坐标系的相对位姿，其真值为机械臂末端工具坐标系在世界坐标系下的相对位姿。
\subsection{任务难点}
手机BTB连接器的位姿检测任务面临多重技术挑战，主要体现在以下几个方面：

\begin{itemize}
\item \textbf{连接器类型多样，适应性要求高：} 即使在同一型号的手机中，也可能包含多种不同形态与结构的BTB连接器。这种多样性要求检测算法具备较强的泛化能力与鲁棒性，能够在不同种类的连接器之间实现稳定识别与位姿估计。此外，在实际生产环境中，手机型号更新换代频繁，检测系统必须具备良好的迁移能力，能够在无需大量重训练的情况下快速适应新型号的连接器结构与外观特征。
\item \textbf{结构形貌复杂，视觉特征不显著：} 相较于传统的规则形插头，BTB连接器表面形貌复杂、外轮廓不规则，且缺乏统一的颜色特征。这种结构复杂性导致其难以通过几何建模或传统基于色彩的图像分割方法进行有效识别。此外，连接器表面通常具有细微的纹理与微结构，这些微结构在图像中难以显著呈现，对图像分辨率和网络提取细节能力提出了更高要求。同时，这些结构也对后续基于力控的柔顺插入控制策略构成了挑战。
\item \textbf{器件微型化，检测精度要求极高：} 手机BTB连接器属于高精密微型器件，其针脚间距通常仅为0.35--0.4mm，单个针脚宽度甚至只有0.2mm。在视觉图像中，这类特征往往只占据极小区域，导致其目标区域在分割与检测是容易漏检。此外，其装配过程对位姿精度的要求高，通常需控制在±0.1mm的位置误差和1.5°以内的角度误差范围内。这对图像采集系统的分辨率、图像处理算法的检测精度及整个检测系统的稳定性提出了极高要求。
\end{itemize}
\section{端到端的网络总体框架设计}
在对框架进行介绍之前，需要再次明确基于深度学习的位姿检测的核心任务。网络的输入为有相对位移的图片，输出为估计的相对位姿，使用机器人末端工具坐标系的相对位姿作为训练的标签。为了完成该任务，网络需要完成以下步骤：

\begin{enumerate}
  \item \textbf{特征提取和编码：}输入的图片需要经过特征提取和编码，需要网络能够对信息进行抽象，提取图片中能表示零件位置的信息进行编码和数据降维，将数据从像素空间转化到特征空间。
  \item \textbf{特征对比：}网络的期望输出是两张图片的相对位移，因此需要进行“求差”的操作，对网络来说则是对特征向量进行对比。
  \item \textbf{任务回归：}根据输出任务，将对比的特征向量按照输出要求进行回归和维度转换，输出相对位姿。
  \item \textbf{损失计算和梯度回传：}根据输出的相对位姿和标签进行损失计算，回传梯度，更新网络参数。
\end{enumerate}

根据上述步骤和思想，设计了如\ref{fig:Network}所示的网络结构。该网络结构分为四个模块，分别是特征编码模块，特征对比模块，任务回归模块和损失计算模块。网络的工作流程为，输入两张通过单目相机采集的具有相对位姿的待检测图片，使用自掩码编码器对输入进行特征提取和编码，再使用交叉注意力对特征向量进行对比计算，然后根据预测任务，将对比向量进行降维，输出为三维预测位姿，最后使用平滑$L_{1}$范数计算预测输出和标签真值的差异，将梯度损失回传，完成一次参数更新。每个模块的设计思路和实现方法将在后续章节中详细介绍。
\InsertFigure[Network]{0.8\textwidth}{位姿检测框架示意图}{framework/Network.png}%

\section{端到端的网络主要模块结构设计}
\subsection{特征编码模块}
有效的特征编码是实现高精度位姿检测的关键，该模块要求能够对输入具有较强的抽象能力，对各种复杂背景和光照条件下的零件进行有效编码。除了强大的编码能力，相对位姿检测任务相较于常见的图像分类和实例分割任务还存在本质的不同。图像分类和实例分割任务要求编码器具有不变行性，即将输入进行旋转平移变换，输出保持不变，而相对位姿检测任务则要求编码器具有等变性，即输入进行旋转平移变换，输出也进行相应的旋转平移变换，其数学关系如\eqref{eq:transkeep}所以。因此，特征编码模块设计时需着重考虑以上两点，分别是强大的编码能力和等变性。
  \begin{equation} \label{eq:transkeep}
    \begin{aligned}
    f(T(x)) &= f(x) \\
    f(T(x)) &= T(f(x)) 
    \end{aligned}
  \end{equation}

  在图像处理领域，常见的编码器有两种，一种是以卷积神经网络（CNN）为基础的编码器，另一类是以视觉变换器（ViT）为基础的编码器。CNN在图像处理领域经过多年的发展，已经形成了成熟的网络结构和训练方法，具有较强的特征提取能力。其核心计算操作是使用卷积核对全图进行扫描计算，获得特征图，再进行池化操作增大感受野，并对输入进行压缩和降维，因此其具有较好的平移不变性，在图像分类领域有广泛的应用\cite{he2016deep}。但其全局感受能力较弱，等变性差。ViT则是近年来新兴的网络结构，它是变换器（Transformer）结构在视觉领域的推广\cite{dosovitskiy2020image}，Transformer编码器则是自注意力层、归一化层、前向层和残差连接为基础模块的编码结构，其自注意力机制在于捕获不同向量之间的潜在关联，归一化层是为了保证训练时的数值稳定，前向层通过全连接层对特征进行转译，残差连接保证了梯度回传、减少信息损失，使得网络可以有更大的深度，更强的编码能力\cite{vaswani2017attention}。但Transformer编码器针对词向量进行操作，因此ViT在使用Transformer编码器前，先将图片进行分块编码，将其转化为多个词向量，然后添加位置编码来保证全局位置关系，最后将其输入给多层Transformer编码器进行编码。一方面，Transformer编码器保持了全局位置关系，拥有全国感受野，能够更好捕捉全局信息，获得位置关系的同时，保证了其等变形的性质，另一方面，ViT的每一层都采用残差连接，使得其网络结构可以更深，具有更强的特征提取能力。

\begin{subfigures}[submodules]{主要模块设计}
  \SubFigure[FutureEncoder]{0.8\textwidth}{0.25\textwidth}{ViT编码器\cite{dosovitskiy2020image}}{framework/ViTa.png}%
  \SubFigure[ScaledMultiHeadAttention]{0.8\textwidth}{0.35\textwidth}{交叉注意力结构\cite{vaswani2017attention}}{framework/ViTb.png}%
  \SubFigure[MultiHeadAttention]{0.8\textwidth}{0.35\textwidth}{交叉注意力模块\cite{vaswani2017attention}}{framework/ViTc.png}%
\end{subfigures}

ViT编码器在特征提取能力和等变性上都具有较强的优势，因此本研究选择ViT作为特征编码模块的基础结构。ViT编码器的结构如\ref{fig:FutureEncoder}所示，分块编码将输入图片进行分块处理，将其转化为多个词向量，位置编码则是为了保证全局位置关系，最后将其输入给多层Transformer编码器进行编码。使用的Transformer的主要结构参数如下：输入图片分辨率为224*224，分块尺寸为16*16，模块层数为12层，隐藏层的维度为768，多头注意力头数为12个，全连接层随机丢弃率为0.1，归一化方式采用层归一化。
\subsection{特征对比模块}
特征对比模块的主要任务是对两张图片的编码向量进行对比，从而形成对比向量，将特征向量的绝对位姿信息转化为相对位姿信息。因此，该模块设计时应该蕴涵差异计算的思想。

在深度学习领域，直接将特征向量做差会导致信息损失和数值不稳定，为了计算向量差异通常考虑两个向量的内积。在网络训练过程中，为了保证数值稳定，向量都是分布在0到1之间，因此，两个特征向量的模长是一致的，向量的内积大小只和向量的取向有关，向量的取向越相近，内积越大，向量相似度越高，因此可以用向量的内积来衡量向量的相似度，反过来其也可以反应两向量的差异。交叉注意力就是利用了这个思想，交叉注意力的计算过程如\ref{fig:ScaledMultiHeadAttention}所示。交叉注意力的计算过程分为三个步骤，首先将输入的两个特征向量进行线性变换，得到查询向量$Q$、键向量$K$和数值向量$V$，然后计算查询向量和键向量的内积，得到注意力权重矩阵$A$，最后将注意力权重矩阵进行SoftMax归一化和数值向量进行加权求和，得到输出特征向量，输出的特征向量即为所需对比向量。在实际使用时，在输入输出部分添加线性层用于转译，将两个对比向量进行拼接，得到最终的对比向量，减少信息损失。其结构如\ref{fig:MultiHeadAttention}所示。交叉注意力模块的主要参数设置如下：输入特征向量维度为768，输出特征向量维度为1536，交叉注意力头数为12，随机丢弃率为0.1，归一化方式采用层归一化。

\subsection{任务回归模块和损失计算模块}
任务回归模块的主要任务是将对比向量进行降维，输出相对位姿。由于相对位姿是一个三维向量，因此该模块的设计需要考虑到输出的维度和数值范围。

\InsertFigure[FC]{0.8\textwidth}{任务回归模块}{framework/FC.png}%

一般任务回归模块设计相对简单，采用全连接层进行线性转译即可，但由于ViT将每个分块编码成一个特征向量，因此输出的向量维度为$[B,N,L]$，其中$N$为分块数，$L$为特征向量维度，因此需要对各个通道先进行均值池化。另外，预测输出的范围需要和相对位姿的数值范围对齐，需要对输出进行归一化处理。为了保证输出的数值范围，使用了Tanh函数进行归一化处理，Tanh函数的输出范围为-1到1，将输出乘以一个常数$C$，使得输出的数值范围在$[-C,C]$之间。任务回归模块的主要参数设置如下：输入特征向量维度为1536，输出特征向量维度为3，随机丢弃率为0.1，归一化方式采用批归一化。其中，各层参数如\ref{fig:FC}所示。

在训练时，使用平滑$L_{1}$范数作为损失函数，计算标签真值和预测输出的差异，平滑$L_{1}$范数的计算方式如\eqref{eq:loss}所示。当输入较大时，平滑$L_{1}$范数等价于$L_2$范数，当输入较小时，平滑$L_{1}$范数等价于$L_{1}$范数，其优点在于相较于$L_1$范数其对异常值不敏感，在零点可导，能够有效避免异常值对训练的影响，同时，相较于$L_2$范数，其梯度性质更好，优化效果更好。
\begin{equation} \label{eq:loss}
  L_{smoothL1}(x) = \begin{cases}
    0.5x^2 & \text{if } |x| < 1 \\
    |x| - 0.5 & \text{otherwise}
  \end{cases}
\end{equation}

\section{数据集构建与训练}
\subsection{数据集构建}
\begin{itemize}
  \item 核心要点：介绍数据采集和标注方法，给出数据集的精度和规模等信息。以及为了模拟各种工况的目的和处理方式。
\end{itemize}
\subsection{训练方法}
除了网络结构外，网络的训练方式也是实现高精度位姿检测的关键。网络的结构是实现高精度位姿检测的基础，而网络的训练方式则是实现高精度位姿检测的关键。根据万能逼近定理，深度学习网络的表达能力是无限的，但其训练方式决定了网络的收敛速度和收敛精度。为了实现高精度位姿检测，需要对网络进行有效的训练。

在本章提出的网络中，使用了两阶段的训练方式，第一阶段使用自监督学习进行预训练，训练编码器的特征编码能力，第二阶段使用有监督学习进行微调，训练特征对比和任务回归模块。

\InsertFigure[MAE]{0.8\textwidth}{掩码自编码器预训练}{framework/MAE.png}%

编码器的训练方法借鉴了掩码自编码器（MAE）\cite{he2022masked}的训练方法，即在输入图片中随机掩码掉四分之三的图像块，然后使用编码器对掩码后的图片进行编码，最后使用解码器对全图进行重建。由于掩码图像块是随机选择的，因此网络需要学习到不同图像块之间的关联和全局的信息，从而实现对掩码图像块的重建，具体结构如\ref{fig:MAE}所示。

掩码自编码器的优点在于，在结构上，其采用了不对称的编解码结构，编码器结构层数更多，参数量更大，具有更强的特征提取能力，解码器结构层数较少，参数量小。这使得，一方面，更小的解码器参数量加速了训练过程，另一方面，更简单的解码器迫使编码器学习到更高层的特征，具有更强的特特征提取能力。在训练方法上，掩码自编码遮盖了大部分的图像块，这同样使得编码器需要学习到全局，高层的特征，强化特征提取能力，也使得输入的图像块数量大大减少，计算开销更小，加速了训练过程。在任务选择上，掩码自编码器对全局图像进行重建，因此，编码器输出的特征向量需要包含全局信息，自然包含了位姿信息，并且图像重建是符合等变性原则，因此，掩码自编码器的训练方法符合位姿检测对特征提取能力和等变形的要求。

在微调训练阶段，使用位姿标签真值进行有监督的训练，训练较少的代数，微调编码器参数的同时，训练特征对比和任务回归模块。由于特征对比和任务回归模块的参数采用随机初始化，在训练一开始会存在较多的“脏数据”，这些数据不利于参数的更新，因此采用“warm up”策略，前期使用较小的学习率进行训练，随着训练的进行，逐渐增大学习率，最后使用较大的学习率进行训练。这样可以避免前期“脏数据”对参数更新的影响，同时也可以加速训练过程。

两阶段具体的训练参数设置如所示。


\section{本章小结}
\begin{itemize}
  \item 核心要点：使用简要的语言总结本章的研究内容，给出本章的研究成果。
\end{itemize}
\chapter{位姿检测网络详细结构设计与优化}
\begin{itemize}
  \item 核心要点：针对给出的标准网络框架，分析其存在的问题，并给出问题解决方案，给出视触觉位姿检测网络的结构，详细模块设计，实验对比与分析结果。
\end{itemize}
\section{问题分析与解决方案}
\section{详细结构设计}
\subsection{光照对齐模块}
\subsection{掩码生成策略}
\subsection{触觉点云生成}
\section{消融实验与问题分析}
\begin{itemize}
  \item 核心要点：四种工况下的结果与之前对比，阐释实验效果，并给出现有问题分析。
\end{itemize}
\section{本章小结}
\begin{itemize}
  \item 核心要点：使用简要的语言总结本章的研究内容，给出本章的研究成果。
\end{itemize}
\chapter{综合实验与分析}
\section{视觉检测算法对比}
\subsection{基于阈值分割的传统视觉算法}
\begin{itemize}
  \item 核心要点：基于特征工程的传统视觉的基本思路与处理框架，包括形态学处理、自定义二值化、边缘检测、主成分分析算法等。
\end{itemize}
\subsection{基于YOLO的分割分析两阶段的算法}
\begin{itemize}
  \item 核心要点：基于YOLO的分割分析两阶段的算法的基本思路与处理框架，包括yolo分割、lda费舍判别等。
\end{itemize}
\subsection{定量实验与结果分析}
\begin{itemize}
  \item 核心要点：将现有算法和两种优化算法进行对比，给出使用建议。
\end{itemize}
\section{实机硬件系统搭建与数学模型}
\subsection{硬件搭建与选型}
\subsection{系统数学模型与坐标系标定}
\section{软件系统框架}
\subsection{总体框架设计}
\subsection{识别抓取算法模块}
\subsection{检测对准算法模块}
\subsection{柔顺插入控制算法模块}
\section{实验效果与分析}
\section{本章小结}

\chapter{总结与展望}
\begin{itemize}
  \item 核心要点：总结现有成果与问题，给出未来展望。
\end{itemize}
\section{研究成果总结}
\section{未来展望}

\bibliography{references}%声明并放置参考文献

\StartAppendix% 附录开始
\chapter{外文资料的调研报告（或书面翻译）}
\begin{center}
调研阅读报告题目（或书面翻译题目）
\end{center}

写出至少 5000 外文印刷字符的调研阅读报告或者书面翻译 1-2 篇（不少于2 万外文印刷符）。

这是附录中的插图示例，
\InsertFigure[appdxfig]{}{附录中的插图示例}{sample.png}%
附录中的图片编码前冠以附录的序号，例如“\ref{fig:appdxfig}”。表格及公式亦如是，这里不再赘述。

\begin{center}
参考文献（或书面翻译对应的原文索引）
\end{center}
\begin{reflist}
  \item 调研报告中的参考文献，请自行编号。
\end{reflist}

\chapter[require]{清华大学综合论文训练写作规范（试行）}
在综合论文训练阶段，本科生须在指导教师的指导下针对某一课题进行探讨、分析和研究，并完成一篇论文。学生应遵照本规范的具体要求进行撰写。原则上，本科生（含国外来华留学本科生）非外语专业论文统一要求用汉语书写。

\section{论文组成部分及顺序}
论文应包含以下部分，顺序如下：
\begin{itemize}
  \item 封面
  \item 关于论文使用授权的说明
  \item 摘要
  \item Abstract
  \item 目录
  \item 插图和附表清单（如有）
  \item 符号和缩略语说明（如有）
  \item 正文：第1章（引言或绪论），第2章，……，结论
  \item 参考文献
  \item 附录
  \item 致谢
  \item 声明
  \item 在学期间参加课题的研究成果（如有）
  \item 综合论文训练记录表
\end{itemize}
以上各项均独立成为一部分，每部分从新的一页开始。

\section{论文格式要求}

\noindent\textbf{（一）封面}

\textbf{题目：}论文题目严格控制在25个汉字（符）以内。字体采用黑体一号字，居中书写。一行写不下时可分两行写，并采用1.25倍行距，断行应合理，应保持术语和词语连续。

\textbf{系别：}院（系）名称的全称。

\textbf{专业：}以本年级《学生手册》中的清华大学本科专业设置为准。

\textbf{姓名：}填写论文作者姓名。

\textbf{指导教师：}填写指导教师姓名，后衬指导教师专业技术职务，如“教授”、“研究员”等，副指导教师、联合指导教师与此相同。

系别、专业、姓名及指导教师信息部分使用仿宋三号字。若不超过4个汉字，作者姓名和指导教师姓名应等宽，各自应保持均匀间隔。

\textbf{论文成文打印日期：}填写论文成文打印的日期，用宋体三号字，不用阿拉伯数字。

\noindent\textbf{（二）关于论文使用授权的说明}

单设一页，排在封面后。内容为“本人完全了解清华大学有关保留、使用综合论文训练论文的规定，即：学校有权保留论文的复印件，允许论文被查阅和借阅；学校可以公布论文的全部或部分内容，可以采用影印、缩印或其他复制手段保存论文。”

此部分内容可以直接下载《清华大学综合论文训练写作规范（试行）》附件的WORD 文档，相应地复制到论文中即可，在提交论文时作者和指导教师都必须签署姓名。

\noindent\textbf{（三）摘要}

\noindent 1. 中文摘要

此部分单设一页。标题为“摘要”，用黑体三号字，居中书写，段前空24磅，段后空18磅，单倍行距。内容部分采用宋体小四号字，两端对齐，行距用固定值20 磅，段前后0磅。

论文摘要中不要出现图片、图表、表格或其他插图材料。

关键词是为了文献标引工作、用以表示全文主要内容信息的单词或术语。关键词3~5个，另起一行，排在摘要的左下方，每个关键词之间用分号间隔。

\noindent 2. 英文摘要

中文摘要页后为英文摘要，单设一页。标题为“Abstract”，用Arial体三号字，居中书写，段前空24磅，段后空18磅，单倍行距。内容采用Times New Roman体小四号，两端对齐，行距用固定值20磅，段前后0磅，标点符号用英文标点符号。“Keywords”与中文摘要部分的关键词对应，每个关键词之间用分号间隔。

论文摘要的中文版与英文版文字内容要对应。

\noindent\textbf{（四）目录}

目录是论文各组成部分章、节序号和标题行以及页码按顺序的排列，列至二级节标题（例如1.2.5）即可。目录内容从正文部分开始，直至论文结束。

目录的标题用黑体三号字，居中书写，单倍行距，段前空24磅，段后空18磅。目录中的章标题行居左书写，一级节标题行缩进1个汉字符，二级节标题行缩进2个汉字符。目录中的章标题采用小四号字，中文采用黑体，英文和数字采用Arial体。其他内容采用宋体小四号字，行距为固定值20磅，段前、段后均为0磅，英文和数字用Times New Roman体。章标题和节标题要简洁，尽可能保持在一行内，若确有必要超过一行，采用悬挂对齐的方式。

目录宜在文档编辑软件中自动生成，并根据上述要求调整格式。

\noindent\textbf{（五）插图和附表清单}

论文中插图和附表较多时，应分别列出“插图清单”和“附表清单”。插图清单在前，应列出图序、图题和页码。附表清单在后，应列出表序、表题和页码。

插图较多而附表较少、或者插图较少而附表较多、或者二者均较少时，可将插图和附表合在一起列出“插图和附表清单”，插图在前、附表在后。

插图和附表清单另起一页，置于目录之后。

章标题“插图清单”“附表清单”或“插图和附表清单”使用黑体三号字，居中，段前空24磅，段后空18磅，单倍行距。内容部分中文采用宋体小四号字，英文和数字采用Times New Roman体小四号，行距为固定值20磅，段前、段后均为0磅。图表标题应简洁，尽可能保持在一行内，若确有必要超过一行，采用悬挂对齐的方式。图中的分图无需在图表清单中体现。

插图与附表清单宜在文档编辑软件中自动生成，并根据上述要求调整格式。

\noindent\textbf{（六）符号和缩略语说明}

如果论文中使用了大量的物理量符号、标志、缩略词、专门计量单位、自定义名词和术语等，应编写“符号和缩略语说明 ”。如果符号和缩略词使用数量不多，可以不设专门的“符号和缩略语说明”，而在论文中出现时随即加以说明。

章标题“符号和缩略语说明”使用黑体三号字，居中书写，单倍行距，段前空24 磅，段后空18磅。内容部分采用宋体小四号字，行距为固定值20磅，段前、段后均为0磅。英文和数字用Times New Roman体。

\noindent\textbf{（七）正文}

\noindent 1. 一般要求

此部分是论文的主体，应从另页右页开始，每一章应另起页。主体部分一般从引言（绪论）开始，以结论结束，分章节论述，层次分明、逻辑性强。

\noindent 2. 标题格式

\textbf{各章标题，例如：“第1章 引言”}

章序号采用阿拉伯数字，章序号与标题名之间空一个汉字符。采用三号字，居中书写，中文采用黑体，英文和数字采用Arial体，单倍行距，段前空24磅，段后空 18 磅。论文的摘要、目录、插图和附表清单、符号和缩略语说明、参考文献、附录、致谢、声明、综合论文训练记录表等部分的标题与章标题属于同一等级，也使用上述格式；英文摘要部分的标题“Abstract”采用Arial体三号字。

\textbf{一级节标题，例如：“2.1 实验装置与实验方法”}

节标题序号与标题名之间空一个汉字符（下同）。采用四号（14pt）字居左书写，中文采用黑体，英文和数字采用Arial体，行距为固定值20磅，段前空24磅，段后空6磅。

\textbf{二级节标题，例如：“2.1.1 实验装置”}

采用13pt字居左书写，中文采用黑体，英文和数字采用Arial体，行距为固定值20磅，段前空12磅，段后空6磅。

\textbf{三级节标题，例如：“2.1.2.1 归纳法”}

采用小四号（12pt）字居左书写，中文采用黑体，英文和数字采用 Arial 体，行距为固定值20磅，段前空12磅，段后空6磅。一般情况下不建议使用三级节标题。

\noindent 3. 论文段落的文字部分

采用小四号（12pt）字，汉字用宋体，英文用Times New Roman体，两端对齐书写，段落首行左缩进2个汉字符。行距为固定值20磅（段落中有数学表达式时，可根据表达需要设置该段的行距），段前空0磅，段后空0磅。
上述论文段落文字格式亦适用于正文后附录、致谢等部分的段落文字。

\noindent 4. 注释脚注

当论文中的字、词或短语，需要进一步加以说明，而又没有具体的文献来源时，用注释，采用文中编号加“脚注”的方式。在正文中需要注释的句子结尾处用%
\begingroup\setmainfont{SimSun}\textsuperscript{①②③}\endgroup
……样式的数字编排序号，以“上标”字体标示在需要注释的句子末尾。在当页下部书写脚注内容。

脚注内容采用小五号字，中文用宋体，英文和数字用Times New Roman体，两端对齐格式，段前后均空0磅，单倍行距，悬挂缩进1.5字符。脚注的序号按页编排，不同页的脚注序号无须连续。

论文中应注意区分各种字符的正斜体、黑白体、大小写、上下角标、上下偏差等。

\clearpage\noindent 5. 字体、字型、字号及段落格式要求表
\begin{table}[format1]
{字体、字型、字号及段落格式要求表}{p{3em}p{4.5em}p{5em}p{6.5em}p{14.5em}}
{& \textbf{文字举例} & \textbf{中文字体、\newline 字号要求} & \textbf{英文及数字字体、字号要求} & \textbf{其他格式要求}}
\textbf{章标题} & 第1章 & 黑体三号字 & Arial三号 & 居中书写，单倍行距，段前空24磅，段后空18磅 \\
\textbf{一级节标题} & 4.1 实验方法 & 黑体四号字 & Arial体14pt & 居左书写，行距为固定值20磅，段前空24磅，段后空6磅 \\
\textbf{二级节标题} & 3.2.2 实验 装置 & 黑体13pt & Arial体13pt & 居左书写，行距为固定值20磅，段前空12磅，段后空6磅 \\
\textbf{三级节标题} & 5.3.3.2 原\newline 材料 & 黑体小四号字 & Arial体12pt & 居左书写，行距为固定值20磅，段前空12磅，段后空6磅。 \\
\textbf{正文} & 实验预期效果 & 宋体小四字 & Times New Roman 12pt & 两端对齐书写，段落首行左缩进2个汉字符。行距为固定值20磅（段落中有数学表达式时，可根据表达需要设置该段的行距），段前空0磅，段后空0磅 \\
\textbf{图题} & 图1.1 达\newline 芬奇系列医疗手术机器人 & 宋体五号字 & Times New Roman 11pt & 居中书写，段前空6磅，段后空12磅，单倍行距，图序与图题文字之间空一个汉字符宽度 \\
\textbf{表题} & 表2.13飞\newline 行时间质谱装置 & 宋体五号字 & Times New Roman 11pt & 居中书写，段前空12磅，段后空6磅，行距为单倍行距，表序与表题文字之间空一个汉字符宽度。 \\
\textbf{参考文献} & [1] 作者.\newline 文题…… & 宋体五号字 & Times New Roman 11pt & 行距采用固定值16磅，段前空3 磅，段后空0磅。采用悬挂格式，悬挂缩进2个汉字符或1个厘米。 \\
\textbf{脚注} & 源于…… & 宋体小五号字 & Times New Roman 小五号 & 两端对齐格式，悬挂缩进1.5字符，段前后均空0pt，单倍行距。\\
\end{table}

\noindent\textbf{（八）量和单位}

严格执行国家标准GB 3100—1993、GB/T 3101—1993和GB/T 3102—1993有关量和单位的规定。单位名称的书写，可以采用国际通用符号，也可以用中文名称，但全文应统一，不得两种混用。

\noindent\textbf{（九）有关图、表和表达式}

图、表和表达式一律采用阿拉伯数字编号，并按章编号，前一位数字为章的序号，后一位数字为本章内图、表或表达式的顺序号。两数字间用小数点“.”或半角横线“-”连接。例如“图2.1”或“图2-1”，“表3.1”或“表3-1”等。表达式在文字叙述中采用“式（3-1）”或“式（3.1）”形式，在编号中用“（3-1）”或“（3.1）”形式。若图或表中有附注，采用英文小写字母顺序编号，附注写在图或表的下方。

附录中图、表、表达式的编号，应与正文中的编号区分开，即在阿拉伯数码前冠以附录的编号，如附录A中的图和表，表示为“图A.1”，“表A.2”等。

\noindent 1. 图

图包括曲线图、构造图、示意图、框图、流程图、记录图、地图、照片等。图应具有“自明性”，即只看图、图题和图例，不阅读正文，就可理解图意。图要精选，切忌与表及文字表述重复。图中的术语、符号、单位等应与正文表述中所用一致。

图应有编号和图题，例如：“图 2.1 发展中国家经济增长速度的比较（1960-2000）”。 图 2.1 是编号，代表“第2章第1个图”，以此类推，“发展中国家经济增长速度的比较（1960-2000）”是图题。图的编号与图题置于图下方，采用11pt字居中书写，汉字用宋体，英文和数字用Times New Roman体，段前空6磅，段后空12磅，行距为单倍行距，图的编号与图题文字之间空一个汉字符宽度。

图中标注的文字宜采用9～10.5pt，以能够清晰阅读为标准，且全文保持一致。专用名字代号、单位可采用外文表示，坐标轴题名、词组、描述性的词语均须采用中文。考虑到图的复制效果和成本等因素，图中不同序列的点、线、条块等宜使用不同形状、线型、填充图案等加以区分，尽量避免使用颜色区分。

如果一个图由两个或两个以上分图组成时，各分图分别以(a)、(b)、(c)……作为图序，并须有分图题。如果分图编号嵌在图中，字号可略大于图中标注文字的字号以示区别，并保持全文一致；如果置于图片下方，字号宜与图的编号和图题字号保持一致。

图宜紧置于首次引用该图的文字之后。图应尽可能显示在同一页（屏）。如图太宽，可逆时针方向旋转 90°放置。图页面积太大时，可分别配置在两页上，次页上应注明“（续）”，并注明图题（可省略），例如“图 2.1（续） 发展中国家经济增长速度的比较（1960-2000）”。

如需英文图名，应中英文对照，英文图的编号与图名另起一行放在中文下方。英文编号和内容应和中文一致，如“Fig 2.1 Comparison of economic growth rates indeveloping countries (1960-2000)”

\noindent 2. 表

表应具有“自明性”。表中参数应标明量和单位的符号。表头中应标明量和单位表示符号，表中的数字后面不再加单位符号。建议采用三线表，表的上、下边线为单直线，线粗为1.5磅；第三条线为单直线，线粗为1磅。

表单元格中的文字一般应居中书写（上下居中，左右居中），不宜左右居中书写的，可采取两端对齐的方式书写。表单元格中的文字采用11pt字书写，汉字用宋体，英文和数字用Times New Roman体，单倍行距，段前空3磅，段后空3磅。

表应有编号与表题，例如：“表3.1 第四次全国经济普查数据（北京）”。 表3.1是编号，代表“第3章第1个表”，以此类推，“第四次全国经济普查数据（北京）”是表题。表的编号与表题置于表上方，采用11pt字居中书写，汉字用宋体，英文和数字用Times New Roman 体，段前空12磅，段后空6磅，行距为单倍行距，表序与表题文字之间空一个汉字符宽度。

如某个表需要转页接排，在随后的各页上应重复表的编号，编号后跟表题（可省略）和“（续）”，置于表上方，例如“表3.1（续） 第四次全国经济普查数据（北京）”，续表均应重复表头和关于单位的陈述。

若在表下方注明资料来源，则此部分用五号字，汉字用宋体，英文用Times New Roman 体，单倍行距，段前空6磅，段后空12磅。需要续表时，资料来源注明在续表之下。

如需英文表名，应中英文对照，英文表的编号与表名另起一行放在中文下方。英文编号和内容应和中文一致，如“Table 3.1 Data from the Fourth National Economic Census (Beijing)”。

\noindent 3. 表达式

表达式主要是指数字表达式，例如数学表达式，也包括文字表达式。

表达式应另起一行，采用与正文相同的字号居中书写，或另起一段空两个汉字符书写，一旦采用了上述两种格式中的一种，全文都要使用同一种格式。表达式应有编号，编号应加括号置于表达式右边行末，编号与表达式之间不加任何连线。

较长的表达式必须转行时，应在“=”或者“+”“-”“×”“/”等运算符或者“]”“\}”等括号之后回行。上下行尽可能在“=”处对齐。

表达式采用Cambria Math或Times New Roman体，采用12pt字书写，行距为单倍行距，段前空6磅，段后空6磅。

当表达式不是独立成行书写时，应尽量将其高度降低为一行，例如，将分数线书写成“/”，将根号改为负指数，例如2\textsuperscript{-1/2}。

\noindent\textbf{（十）参考文献}

参考文献是文中引用的有具体文字来源的文献集合，列出作者直接阅读过、在正文中被引用过、正式或非正式发表的刊物、文献及资料。参考文献的写法应遵循国家标准《信息与文献参考文献著录规则》（GB/T 7714—2015）；符合特定学科的通用范式，可使用APA或《清华大学学报（哲学社会科学版）》格式，且应全文统一，不能混用。参考文献一律放在论文结论后，不得放在各章之后。在论文正文中引用了参考文献的部位，须用上标标注[参考文献序号]。

“参考文献”四个字的格式与章标题的格式相同。参考文献表的正文部分用五号字，中文用宋体，英文和数字用Times New Roman体，行距采用固定值16磅，段前空3磅，段后空0磅。采用悬挂格式，悬挂缩进2个汉字符或1厘米。

每一条文献的内容要尽量写在同一页内。遇有被迫分页的情况，可通过“留白”或微调本页行距的方式尽量将同一条文献内容放在一页。

关于参考文献国家标准《信息与文献参考文献著录规则》（GB/T 7714—2015）的著录格式以及在正文中的标注方法详见《清华大学综合论文训练写作规范（试行）》附件的《参考文献著录规则及注意事项》。

\noindent\textbf{（十一）附录}

附录的格式与正文相同，并依顺序用大写字母 A，B，C，……编序号，如附录A，附录B，附录C，……。只有一个附录时也要编序号，即附录A。每个附录应有标题。附录序号与附录标题之间空一个汉字符。例如：“附录A 外文资料的调研阅读报告”。

附录中的图、表、数学表达式、参考文献等另行编序号，与正文分开，一律用阿拉伯数字编码，但在数码前冠以附录的序号，例如“图A.1”，“表B.2”，“式（C-3）”等。

附录内容分为以下两部分：

1、附录A

附录A为外文资料的调研阅读报告或书面翻译。调研阅读报告需附参考文献；书面翻译需注明外文资料原文的索引。标题为“外文资料的调研阅读报告”或“外文资料的书面翻译”。

调研阅读报告的参考文献（或书面翻译对应的外文资料的原文索引）格式与正文参考文献格式相同。

2、其他附录

其他附录是与论文内容密切相关、但编入正文又影响整篇论文编排的条理和逻辑性的资料，例如某些重要的数据表格、计算程序、统计表等，是论文主体的补充内容，可根据需要设置。其他附录序号为附录B，附录C，……。

\noindent\textbf{（十二）致谢}

致谢包括内容如：对国家科学基金、资助研究工作的奖学金基金、合同单位、资助或支持的企业、组织或个人，对协助完成研究工作和提供便利条件的组织或个人，对在研究工作中提出建议和提供帮助的人，对给予转载和引用权的资料、图片、文献、研究思想和设想的所有者，对其他应感谢的组织和个人。

致谢单设一页。标题为“致谢”。内容部分采用宋体小四号字，行距用固定值20 磅，段前后0磅。

\noindent\textbf{（十三）声明}

关于论文内容没有侵占他人著作权的声明，放在致谢页后，单独一页。标题为“声明”。内容为“本人郑重声明：所呈交的综合论文训练论文，是本人在导师指导下，独立进行研究工作所取得的成果。尽我所知，除文中已经注明引用的内容外，本论文的研究成果不包含任何他人享有著作权的内容。对本论文所涉及的研究工作做出贡献的其他个人和集体，均已在文中以明确方式标明。” 确认无误后，慎重签名。

此部分内容可以直接下载《清华大学综合论文训练写作规范（试行）》附件的WORD文档，相应地复制到论文中即可，在提交论文时作者必须签署姓名。

\noindent\textbf{（十四）在学期间参加课题的研究成果}

指在本科阶段课题研究中获得的成果，如申请的专利或已正式发表和已有正式录用函的论文等。标题为“在学期间参加课题的研究成果”， 使用黑体三号字，居中书写，单倍行距，段前空24磅，段后空18磅。内容部分用宋体小四号字，行距采用固定值20磅，段前后0磅。

各种类型学术成果的书写格式与正文相同，书写要求如下。

1. 学术论文

参照参考文献书写，尚未刊载但已经接到正式录用函的学术论文加括号注明已被××××期刊录用。

2. 专著/译著

参照参考文献书写，尚未出版但已被出版社决定出版的专著/译著加括号注明出版社名称和预计出版时间。

3. 专利

参照参考文献书写，处于申请阶段的专利在专利号位置填写专利申请号，并加括号注明是专利申请号。

4. 作品

大致按以下方式书写：作者. 作品名称. 创作时间. 材料形式. 作品尺寸. 作品地点. 参展信息. 是否获奖等信息。

5. 研究报告

公开的研究报告参照参考文献书写。

6. 其他

按适当合理的方式书写。

\noindent\textbf{（十五）综合论文训练记录表}

完整和翔实记录综合论文训练开题、中期检查、论文评阅、论文答辩各环节情况。装订于论文的最后。

\noindent\textbf{（十六）页面设置}

论文页面设置如下：
\begin{enumerate}
  \item 封面：纸张规格、尺寸，A4（21厘米×29.7厘米）；页边距，上3.8厘米，下3.2厘米，左3厘米，右3厘米；装订线，0.2厘米，位置左。
  \item 除封面外，其他页面：纸张规格、尺寸，A4（21厘米×29.7厘米）；页边距，上3厘米，下3厘米，左3厘米，右3厘米；装订线，0厘米。
\end{enumerate}
注：论文除“封面”、“关于论文使用授权的说明”采用单面印刷之外，从摘要开始（包括摘要）后面的部分均采用A4幅面白色70克以上80 克以下（彩色插图页除外）纸张双面印刷，正文从另页右页开始。

\noindent\textbf{（十七）页眉和页码}

页眉：无

页码：位于页面底端，居中书写。在第1章（引言或绪论）之前的部分，从前往后用大写罗马数字编排；从第 1 章（引言或绪论）开始，用阿拉伯数字连续编排。综合论文训练记录表无页码。

\noindent\textbf{（十八）书脊的书写要求}

用仿宋字书写，字体大小根据论文的薄厚而定。书脊上方写论文题目，下方写作者姓名，距上下页边均为3cm。

\noindent\textbf{（十九）其它说明}

论文的某些部分内容若为空，如：主要符号表、在学期间参加课题的研究成果、附录B等，则该部分不要作为空白页装订在论文里。论文封皮统一要求使用120克蓝色纸。

\section{模板及相关说明}
本科生综合论文训练论文模板以附件形式单独存成文档，供同学们下载参考。如果模板中存在与本规范中的规定不符之处，以本规范中的文字叙述为准。

\noindent 01 综合论文训练论文模板

\noindent 02 关于论文使用授权的说明

\noindent 03 声明

\noindent 04 在学期间参加课题的研究成果

\noindent 05 综合论文训练记录表

\noindent 06 参考文献著录规则及注意事项

\chapter{关于模板的一些说明}
\section[tplstruct]{全文框架}
在本模板类（documentclass\{Diploma\}）的支持下，综合论文训练全文框架应遵循以下基本规范：
\begin{verbatim}
\documentclass{Diploma}
\usepackage{...}
\SetDepartment{系名}
\SetMajor{专业名}
\SetTitle{论文题名}
\SetAuthor{作者名}
\SetInstructor{教师名}{教师职称}
\begin{document}
\ChsAbstract
%中文摘要内容
\ChsKeywords{中文关键词}
\EngAbstract
%英文摘要内容
\EngKeywords{英文关键词}
\ListOfContents%目录及图表清单
\begin{Abbreviations}
%符号和缩略语列表
\end{Abbreviations}
\StartMainText%正文开始
%正文内容
\bibliography{references}%参考文献
\StartAppendix%附录开始
%附录内容
\Acknowledgments%致谢开始
%致谢内容
\Statement%声明
\Achievements%在学期间参加课题的研究成果
\end{document}
\end{verbatim}

\section[bibref]{参考文献库说明}
参考文献库文件名为“*.bib”，需要在文档中使用“\char92 bibliography”显式地进行引用。“*.bib”文献库文件的基本格式为：
\begin{verbatim}
@entry{code,
   info = {content},
}
\end{verbatim}
其中各项参数的说明如下：
\begin{itemize}
  \item entry，文献类型。常用的是这四种类型：“article”期刊论文、“inproceedings”会议论文、“book”书籍、“thesis”学位论文。不常用的类型还有这些：“report”报告、“standard”标准、“incollection”汇编中的论文、“proceedings”会议论文集、“collection”论文汇编集、“inbook”书籍中的章节、“periodical”连续出版物、“news”新闻。
  \item code，文献代码，具有唯一性的代码，以便“\char92 cite”命令进行引用。
  \item info，文献信息名。
  \item content，文献信息的实际内容。
\end{itemize}
下面将详细列出各种不同类型文献所包含的数据信息及其说明。

\textbf{“article”期刊论文}可包含以下文献信息：
\begin{itemize}
  \item author，作者名。必填项。多个作者名之间用“and”隔开，如“author = \{作者甲 and 作者乙\},”。
  \item title，论文题名。必填项。
  \item journal，期刊名。必填项。
  \item year，出版年。必填项。原则上，期刊的“年卷期”三项信息均应填写。如确有缺失，至少要填写一项。
  \item volume，卷号。必填项。
  \item number，期号。必填项。
  \item pages，页码范围。必填项。给出论文在期刊中的页码范围。
  \item title.aux，其他期刊名。选填项。期刊的“别称”，一般不填。
  \item date，引用日期。选填项。一般不填。
  \item url，电子资源网址。选填项。
  \item doi，唯一的数字对象标识符。选填项。
  \item language，文献语言。选填项。设成“cn”为中文，否则均默认为英文。
\end{itemize}

\textbf{“inproceedings”会议论文}是指会议论文集中的论文，含以下信息：
\begin{itemize}
  \item author，论文作者名。必填项。多个作者名之间用英文“and”隔开。
  \item author.aux，论文其他作者。选填项。
  \item title，论文名。必填项。
  \item pages，页码范围。必填项。给出论文的具体页码范围。
  \item editor，会议论文集编撰者。选填项。多个编者之间用逗号隔开。
  \item booktitle，会议论文集名称。必填项。
  \item title.aux，会议论文集别名。选填项。
  \item edition，会议论文集版本信息。选填项。会议论文集一般没有版本信息。
  \item address，会议举办地。必填项。
  \item publisher/organization，出版者或会议组织机构。必填项。
  \item year，会议举办年。选填项。
  \item date，引用日期。选填项。一般不填。
  \item url，电子资源网址。选填项。
  \item doi，唯一的数字对象标识符。选填项。
  \item language，文献语言。选填项。
\end{itemize}

\textbf{“book”书籍}可包含以下文献信息：
\begin{itemize}
  \item author，作者名。必填项。作者名之间用“and”隔开。
  \item title，书名。必填项。
  \item address，出版地。必填项。电子资源可省略出版地信息。
  \item publisher，出版者。必填项。电子资源可省略出版者信息。
  \item year，出版年。选填项。
  \item author.aux，其他作者。选填项。此信息常见于译著，可以设置“author”为原文献作者，设置“author.aux”为译者。
  \item title.aux，其他书名。选填项。书籍“别称”，一般不填。
  \item edition，版本信息。选填项。首个版本通常不填写版本信息。
  \item pages，页码范围。选填项。
  \item date，引用日期。选填项。一般不填。
  \item url，电子资源网址。选填项。电子资源可不填出版地、出版者信息。
  \item doi，唯一的数字对象标识符。选填项。
  \item language，文献语言。选填项。
\end{itemize}

\textbf{“thesis”学位论文}可包含以下文献信息：
\begin{itemize}
  \item author，作者名。必填项。
  \item title，学位论文题名。必填项。
  \item address，取得学位论文的城市。必填项。
  \item publisher/organization，取得学位论文的大学或其他学术单位。必填项。
  \item year，取学位的年份。必填项。
  \item title.aux，学位论文的其他题名信息。选填项。
  \item pages，页码范围。选填项。
  \item date，引用日期。选填项。一般不填。
  \item url，电子资源网址。选填项。
  \item doi，唯一的数字对象标识符。选填项。
  \item language，文献语言。选填项。
\end{itemize}
因为国标文件并不明确区分学位论文的类型，所以这里将“mastersthesis”和“phdthesis”设置为“thesis”的别名，三者功能上完全相同。

\textbf{“report”技术报告}是指独立成册的专项报告，可包含以下文献信息：
\begin{itemize}
  \item author，作者名。必填项。
  \item title，报告名。必填项。
  \item edition，版本信息。选填项。
  \item address，出版地。必填项。
  \item publisher，出版者。必填项。
  \item author.aux，其他作者。选填项。
  \item title.aux，其他报告名。选填项。
  \item year，出版年。选填项。
  \item pages，页码范围。选填项。
  \item date，引用日期。选填项。一般不填。
  \item url，电子资源网址。选填项。
  \item doi，唯一的数字对象标识符。选填项。
  \item language，文献语言。选填项。
\end{itemize}

\textbf{“standard”国家/国际标准}是指标准化规范，可包含以下文献信息：
\begin{itemize}
  \item author，作者名。必填项。
  \item title，标准名。必填项。
  \item edition，版本信息。选填项。
  \item address，出版地。必填项。
  \item publisher，出版者。必填项。
  \item author.aux，其他作者。选填项。
  \item title.aux，标准别名。选填项。
  \item year，出版年。选填项。
  \item pages，页码范围。选填项。
  \item date，引用日期。选填项。一般不填。
  \item url，电子资源网址。选填项。
  \item doi，唯一的数字对象标识符。选填项。
  \item language，文献语言。选填项。
\end{itemize}

\textbf{“incollection”汇编论文}是指汇编中的独立论文，可包含以下文献信息：
\begin{itemize}
  \item author，论文作者名。必填项。
  \item author.aux，论文其他作者。选填项。
  \item title，论文名。必填项。
  \item pages，页码范围。必填项。给出论文的具体页码范围。
  \item editor，论文汇编编撰者。选填项。
  \item booktitle，论文汇编名称。选填项。
  \item title.aux，论文汇编别名。选填项。
  \item edition，论文汇编版本信息。选填项。
  \item address，出版地。必填项。
  \item publisher，出版者。必填项。
  \item year，出版年。选填项。
  \item date，引用日期。选填项。一般不填。
  \item url，电子资源网址。选填项。
  \item doi，唯一的数字对象标识符。选填项。
  \item language，文献语言。选填项。
\end{itemize}

\textbf{“proceedings”会议论文集}一般指举办学术会议时产生的会议论文集合，有些会议论文集是公开出版的，有些只对参会者内部分发。可包含以下文献信息：
\begin{itemize}
  \item author，论文集编者。必填项。
  \item author.aux，论文集其他编者。选填项。
  \item title，论文集名称。必填项。
  \item title.aux，会议论文集别名。选填项。
  \item edition，会议论文集版本信息。选填项。会议论文集一般没有版本信息。
  \item address，会议举办地。必填项。
  \item publisher/organization，出版者或会议组织机构。必填项。
  \item year，会议举办年。选填项。
  \item pages，页码范围。选填项。
  \item date，引用日期。选填项。一般不填。
  \item url，电子资源网址。选填项。
  \item doi，唯一的数字对象标识符。选填项。
  \item language，文献语言。选填项。
\end{itemize}

\textbf{“collection”汇编论文集}一般指独立成册的专题论文集，包含以下信息：
\begin{itemize}
  \item author，论文集编者。必填项。
  \item author.aux，论文集其他编者。选填项。
  \item title，论文集名称。必填项。
  \item title.aux，论文集别名。选填项。
  \item edition，论文集版本信息。选填项。
  \item address，出版地。必填项。
  \item publisher，出版者。必填项。
  \item year，出版年。选填项。
  \item pages，页码范围。选填项。
  \item date，引用日期。选填项。一般不填。
  \item url，电子资源网址。选填项。
  \item doi，唯一的数字对象标识符。选填项。
  \item language，文献语言。选填项。
\end{itemize}

\textbf{“inbook”书籍内容}一般指书籍中的某个具体的章节，可包含以下文献信息：
\begin{itemize}
  \item author，章节作者名。必填项。有些书籍每个章节都有单独的作者。
  \item author.aux，章节其他作者。选填项。
  \item title，章节名。必填项。
  \item pages，页码范围。必填项。给出所引用的章节的具体页码范围。
  \item editor，书籍的总编撰者。选填项。若总编与章节作者相同，则不必填此项。
  \item booktitle，书籍名。必填项。
  \item title.aux，书籍别名。选填项。
  \item edition，书籍版本信息。选填项。
  \item address，出版地。必填项。
  \item publisher，出版者。必填项。
  \item year，出版年。选填项。
  \item date，引用日期。选填项。一般不填。
  \item url，电子资源网址。选填项。
  \item doi，唯一的数字对象标识符。选填项。
  \item language，文献语言。选填项。
\end{itemize}

\textbf{“periodical”连续出版物}一般指期刊本身，引用期刊本身是不常见的，一般情况下只引用刊物的某一期中的某一篇文章。可包含以下文献信息：
\begin{itemize}
  \item author，期刊编者名。必填项。
  \item title，期刊名。必填项。
  \item title.aux，期刊别名。选填项。
  \item year，起始出版年。选填项。
  \item volume，起始卷号。必填项。
  \item number，起始期号。必填项。
  \item year，终出版年。选填项。
  \item vol.end，终卷号。必填项。
  \item num.end，终期号。必填项。
  \item address，出版地。必填项。
  \item publisher，出版者。必填项。
  \item date，引用日期。选填项。一般不填。
  \item url，电子资源网址。选填项。
  \item doi，唯一的数字对象标识符。选填项。
  \item language，文献语言。选填项。
\end{itemize}

\textbf{“news”新闻}一般指报刊上的新闻信息，工科论文一般不引用新闻。
\begin{itemize}
  \item author，新闻作者名。必填项。
  \item title，新闻标题。必填项。
  \item newspaper，报刊名。必填项。
  \item title.aux，报刊别名。选填项。
  \item year，出版年。选填项。
  \item number，期号。必填项。
  \item pages，页码范围。必填项。给出所引用的新闻的具体页码范围。
  \item date，引用日期。选填项。一般不填。
  \item url，电子资源网址。选填项。
  \item doi，唯一的数字对象标识符。选填项。
  \item language，文献语言。选填项。
\end{itemize}

\section{不够优雅的dirty trick}
熟练的程序员常常会听到“dirty trick”这个英文词组，直译成中文是“肮脏的把戏”。实际上，这个词组主要是指那些临时性的、非标准的或取巧的解决方案。在本文提供的模板中，也有一些这种临时性的、未经过全面兼容性检验的“dirty trick”。本节将给出一些说明，以备不时之需。

\noindent\textbf{关于字体}

本模板中会用到5种字体：
\begin{itemize}
  \item 字体名Times New Roman，字体文件times.ttf，以及加粗的字体timesbd.ttf。
  \item 字体名Arial，字体文件arial.ttf。
  \item 字体名SimSun，字体文件simsun.ttc。这是中文宋体字，主要用于正文内容。
  \item 字体名SimHei，字体文件simhei.ttf。这是中文黑体字，主要用于标题。
  \item 字体名FangSong，字体文件simfang.ttf。这是中文仿宋体，只用于封面的作者信息等内容。
  \item 字体名DengXian，字体文件deng.ttf。这是中文等线字体，姑且认为这种字体与\LaTeX 中的英文mono字体对应。等线字体主要用于展示源代码，“规范”中对此部分没有硬性规定。
\end{itemize}
以上字体是Windows系统中自带的字体。对于Mac和基于Linux的操作系统，需要手动安装以上字体。或者修改“Diploma.cls”中的相关定义，以使用其他系统中已有的字体。但按“规范”要求，原则上应使用以上字体。

\noindent\textbf{关于数学公式}

在科技界，\LaTeX 是以其强大的数学公式编辑能力而闻名的。为了进一步扩充公式编辑的便利性和规范性，美国数学学会（American Mathematical Society，简称AMS）开发并维护了“amsmath”这个编辑复杂公式时一定会用到的宏包。本模板没有默认引用此宏包，需要使用时可在“\char92 documentclass”命令之后使用“\char92 usepackage\{amsmath\}”命令来引入该宏包，以便使用其提供的丰富功能。

\noindent\textbf{关于功能宏包}

由于\TeX 的开放性（实际情况是\TeX 核心功能太少不够用），全世界有大量的热心人参与开发各式各样的\LaTeX 宏包。本模板默认引入了以下4个宏包：
\begin{itemize}
  \item xeCJK：支持东亚字符（中日韩）。实际上主要是解决了中文字体的设置、汉字间距控制等问题。
  \item graphics：支持在文档中插入图片。此宏包支持大部分的图片格式，jpg、png、tif之类的，应该能够应对绝大部分情况。
  \item longtable：支持长表格（即跨页的表格）。本模板的“符号和缩略语”部分使用了“长表格”功能。
  \item hyperref：为PDF文档添加“链接”功能。例如，点击目录中的章节标题就能直接跳转到对应章节，这是很方便的。不光是目录，所有使用到“引用”的地方，此宏包都会自动加上“链接”功能。
\end{itemize}
实际上，以上4个宏包还会关联引入大量宏包，编译时有相关信息提示。

大量的\LaTeX 宏包固然能够解决很多实际问题，但有时宏包之间有产生“冲突”，出现兼容性问题。毕竟来自世界各地的开发者脾气秉性各不相同，又缺乏强大的组织管理，兼容性问题是不可避免的。相对而言，Word软件的兼容性问题就少得多。考虑到这个因素，在开发本模板时，我们并没有大量的引入宏包，而是尽量只使用标准的、原始的\LaTeX 命令来解决问题。

实际使用时不免需要额外的宏包来解决复杂的排版需求。在“\char92 documentclass”命令之后使用“\char92 usepackage”命令即可引入宏包并实现相应的功能。需要特别说明的是，由于本模板对一些基本命令进行了深度定制，可能会跟某些宏包产生不可控的兼容性问题。欢迎反馈这些兼容性问题，但我们不保证能够解决它。

\noindent\textbf{尽量不自行使用figure或table环境}

有丰富的\LaTeX 使用经验的同学，一定会经常用到figure和table环境。在本模板中，没有给出figure环境的定义，所以如果之前使用了figure环境来插入图片，则需要手动转换为本模板中的“\char92 InsertFigure”、“\char92 MultiFigure”、“\char92 SubFigure”等命令。转换并不困难，只是需要花一些时间。

本模板给出了table环境的定义，但与标准的\LaTeX\ table完全不同。如果之前使用了标准的table环境来插入表格，这里仍然需要进行转换。表格的转换相对会比较繁琐，实在遇到搞不定的问题请及时联系我们并尽量解决。

\noindent\textbf{控制不住的“浮动体”}

在\LaTeX 中，“浮动体”是一个重要的概念，主要指“游离”于文字之外的“图”和“表”。在本模板中，“\char92 InsertFigure”、“\char92 begin\{multifigures\}”、“\char92 begin\{subfigures\}”、“\char92 begin\{table\}”等命令就会产生浮动体。

通常，\LaTeX 系统会按照一般的排版逻辑，根据尽量使“页面充实”的原则，把浮动体排到合适的位置。这个“合适的位置”可能是“伪代码”中浮动体出现的位置，也可能是页面的顶端，也可能是页面的底端，还可能是隔了一页甚至好几页后才出现。总之，给人的感觉是，浮动体出现的位置不可控。其实，这是因为在\LaTeX 允许浮动体脱离上下文，放置在算法认为合适的位置。在技术类论文中，有一种常见的情况：需要根据上下文在某处插入较多的图表。在此算法下，这些图表很有可能会被\LaTeX 放置到远离上下文的页面，从而对读者造成一定的困扰。为了避免出现此类情况，可以使用“\char92 clearpage”命令，强制\LaTeX 系统分页，以不好看的“留白”换取浮动体尽量出现在上下文的近处。如果由此产生的“留白”过大，那么就需要手工精调文字段落来“消除”留白。总之，自动排版算法并不能很好的解决此类问题，作者需要在论文终版时进行手动精调。

本模板按照通常的经验，将浮动体的位置控制选项设置为“!htb”。其中“!”表示排版浮动体时尽量不受算法限制，即更倾向于满足使用者的需求；“htp”表示优先把浮动体排在对应的上下文之中，实在排不下再考虑排到页面顶端或底端。

\noindent\textbf{不守套路的空白}

在\ref{txt:usage}中曾提及，中文\LaTeX “伪代码”里的空格会被自动忽略掉，不对排版产生影响；但中英文之间会自动插入合适的间距。这一机制能够保障大多数时候的排版效果，但偶尔也会出现失效的场景。例如“\char92 LaTeXe”这个命令，若其后紧跟的是中文字符，则按排版规则应自动插入一段“中英文间距”，但实际的排版效果却不是这样。以下代码
\begin{verbatim}
\LaTeXe 汉
\end{verbatim}
的排版效果是“\LaTeXe 汉”，可见其中的字符$\varepsilon$与“汉”字之间是缺少合适的空白间距的。此时就需要显式地加入间距，以下代码
\begin{verbatim}
\LaTeXe\ 汉
\end{verbatim}
的排版效果“\LaTeXe\ 汉”才是正确的。

在另一些情形中，可能会多出空白间距。例如，当我们在上下文中间插入浮动体时，原则上浮动体的前后文字应当是“紧挨”着没有间距的，但却因伪代码换行的问题而产生了多余的间距。例如以下代码
\begin{verbatim}
前
\InsertFigure{}
后
\end{verbatim}
会在“前”、“后”两字之间插入多余的空白间距，这是因为花括号“\}”后的换行符会产生一个“空白”。此时应将代码修正为
\begin{verbatim}
前
\InsertFigure{}%
后
\end{verbatim}
即在“\}”后添加注释符“\%”以便强制消除之后可能会产生的多余空白。

\noindent\textbf{不那么如意的垂直间距}

按“规范”要求，正文段落的行距为固定值20磅。在\TeX 中，行距控制的是“基线间距”，即两行的基线间距离保持20pt。这里就产生了一个问题，对于每一页的第一行，它的基线就是本页面的首个基线，这首个基线应该放什么位置呢？\TeX 系统的处理方式是把基线放到最“靠上”的位置，即把文字顶到最上方放置，并“吃”掉所有的垂直间距。所以，对于每一页的首行文字，会出现以下现象：
\begin{itemize}
  \item 段前垂直间距失效。例如“规范”要求一级节标题段前空24磅，若节标题为首行，实际上不存在这个段前间距。当然，这样的处理方式是符合逻辑的。
  \item 当\TeX 把“浮动体”放置在页面最上方时，“首行文字”仍然是首行文字，段前的垂直空间会失效。此时，“浮动体”与文字的间距会略小，因为本来应该存在的段前间距被“吃”掉了。这就是当图表出现在页首时，图表与文字的间距看起来会略微小一些的原因。本模板已经通过各种方式把这一影响减到最小了。
\end{itemize}

另一方面，按“规范”要求，章标题段后空18磅，一级节标题段前空24磅。因此，当章标题后紧跟一级节标题时，两者间会空出42磅，这当然是比较大的间距。所以，在本模板中，在处理节标题的段前间距时，会先用“\char92 removelastskip”命令取消上一个垂直间距，以避免垂直间距的叠加。

当浮动体出现在页顶时，其与页顶的间距由“\char92 @fptop”控制，\LaTeX 将它默认定义为“0pt plus 1fil”，即：间距默认为0，但可以按需填充。因此，当有浮动体出现在页顶，\LaTeX 系统通常会把所有的可调整间距全部放到页顶与浮动体之间。换言之，此时浮动体与页顶的间距会稍大一些。同样的，当浮动体出现在页底时，间距由“\char92 @fpbot”控制。

\noindent\textbf{BibTeX的逆波兰表达式}

BibTeX的参考文献格式定义文件“*.bst”实际也是一种“程序”，这种“程序”使用了一种比较少见的表达方式，即“逆波兰表达式”。

以加法为例，按人类的思维结构，一个正常的加法表达式应该是这样的“a+b”，即两个“操作数”分别出现在“操作符”的两侧，这就叫“波兰表达式”（Polish Notation）。但是，这种人类容易理解的表达式结构，对于“计算机编译系统”来说，是不方便理解的。对“计算机编译系统”来说，更容易“理解”的形式是：把“操作数”集中放前面，“操作符”放到所有“操作数”之后。这就叫“逆波兰表达式”（Reverse Polish Notation）。例如，波兰表达式“a+b”写成逆波兰表达式的形式应该是“a b +”。

理解了“逆波兰表达式”的特点，就比较容易看懂“bst”文件了。

\Acknowledgments%致谢
衷心感谢指导教师××教授对本人的精心指导。他的言传身教将使我终生受益。

感谢×××××实验室××教授，以及×××××全体老师和同窗们的热情帮助和支持！

……

本课题承蒙×××××基金资助，特此致谢。

以上是“规范”推荐的致谢内容形式。本模板特别感谢马正华、闫济洲、许瀵译、郑皓文同学（排名不分先后）参与调试并提出修订建议。

\Statement%声明

\Achievements%在学期间参加课题的研究成果
\begin{MyPapers}
  \item 	ZHOU R, HU C, OU T, et al. Intelligent GRU-RIC Position-Loop Feedforward Compensation Control Method with Application to an Ul-traprecision Motion Stage[J], IEEE Transactions on Industrial Infor-matics, 2024, 20(4): 5609-5621.
  \item 	杨轶, 张宁欣, 任天令, 等. 硅基铁电微声学器件中薄膜残余应力的研究[J]. 中国机械工程, 2005, 16(14):1289-1291.
  \item YANG Y, REN T L, ZHU Y P, et al. PMUTs for handwriting recogni-tion. In press[J]. (已被Integrated Ferroelectrics录用)
\end{MyPapers}

\vspace{20pt}
\begin{MyPatents}
  \item 	胡楚雄, 付宏, 朱煜, 等. 一种磁悬浮平面电机: ZL202011322520.6[P]. 2022-04-01.
  \item 	REN T L, YANG Y, ZHU Y P, et al. Piezoelectric micro acoustic sensor based on ferroelectric materials: No.11/215, 102[P]. (美国发明专利申请号.)
\end{MyPatents}

\end{document}
